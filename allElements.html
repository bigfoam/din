<!DOCTYPE HTML>
<html>
<head>
	<meta charset="UTF-8">
	<link rel="apple-touch-icon" sizes="57x57" href="images/icon/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="images/icon/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/icon/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="images/icon/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/icon/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="images/icon/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="images/icon/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="images/icon/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="images/icon/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192"  href="images/icon/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="images/icon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="images/icon/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="images/icon/favicon-16x16.png">
	<link rel="manifest" href="images/icon/manifest.json">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="images/icon/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">

	
	<title>Dinneract | Dashboard</title>
	
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"/>
	<link rel="stylesheet" type="text/css" href="css/jquery.tagsinput.min.css"/>
	<link rel="stylesheet" type="text/css" href="css/style.css"/>
	<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans"/>
	<link rel="stylesheet" type="text/css" href="css/font-awesome-4.3.0/css/font-awesome.min.css"/>
	
	
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/bootstrap-list-filter.min.js"></script>
	<script type="text/javascript" src="js/jquery.tagsinput.min.js"></script>

	<script type="text/javascript" src="js/move-top.js"></script>
	<script type="text/javascript" src="js/easing.js"></script>
	
	<script type="text/javascript" src="js/masonry.pkgd.min.js"></script>
    <script type="text/javascript" src="js/imagesloaded.pkgd.min.js"></script>
    <script type="text/javascript" src="js/jquery.infinitescroll.min.js"></script>
	
	<style>
		.post { 
			width: 240px;
			margin: 10px;
			float: left;
		}
		
		.post label {
			width: 240px;
			padding: 2px 16px 2px 16px;
			opacity: 0.8;
		}
		
		.post a img {
			width: 100%;
		}
		
		#title {
			font-size: 20px;
			font-weight: 600;
		}
		
		.carousel-inner > .item {
			text-align: center !important;
		}
		
		.carousel-inner > .item > img {
		    margin: 0 auto;
		}
		
		#photos .carousel-control {
			padding-top: 192px;
		}
		
		.form-group div {
			margin-bottom: 12px !important;
		}
		
		.control-label {
			font-weight: 600;
		}
		
		.pagination li {
			cursor: pointer;
		}
		
		#loading {
			text-align: center;
			padding-top: 400px;
		}
	</style>
</head>
<body>
<!---start-wrap---->
	<!---start-header---->
	<div class="header">
	<div class="wrap">
		<div class="logo">
			<a href="index.html"><img src="images/comp_logo.png"/></a>
		</div>
		<div class="head-nav">
			<ul>
				<li class="active"><a href="index.html#home" class="scroll">Home</a></li>	
			</ul>
		</div>
		<div class="clear"> </div>
	</div>
	<!---//End-header---->
	</div>
	
	<!---start-image-banner---->
	<div class="dash" style="text-align: center; float: none;">
		<div class="content" style="float: none; width: 1100px;">
			
			<div class="row" id="loading">
         		<img src="images/loading-cup.gif" style="display: hidden;"/>
        	</div>
			
			<div class="row" id="product-images">
         
        	</div>
					
		</div>
		<div class="clear"> </div>
		<nav>
		  <ul class="pagination">
		    <li class="disabled" id="prevPages">
		      <a aria-label="Previous">
		        <span aria-hidden="true">&laquo;</span>
		      </a>
		    </li>
		    <li class="active" title="1">
		    	<a>1</a>
		    </li>
		    <li title="2"><a>2</a></li>
		    <li title="3"><a>3</a></li>
		    <li title="4"><a>4</a></li>
		    <li title="5"><a>5</a></li>
		    <li title="6"><a>6</a></li>
		    <li title="7"><a>7</a></li>
		    <li title="8"><a>8</a></li>
		    <li title="9"><a>9</a></li>
		    <li id="nextPages">
		      <a aria-label="Next">
		        <span aria-hidden="true">&raquo;</span>
		      </a>
		    </li>
		  </ul>
		</nav>
		<div class="clear"> </div>
	</div>
	<!---//End-image-banner---->
	
	<!---start-footer----->
	<div class="footer-dash">
		<div class="wrap">

				<div class="footer-left">
					<a href="index.html"><img src="images/comp_logo.png" alt="logo"/></a>
			  	</div>
				<div class="footer-center">
					<div class="cssmenu">
						<ul>
							<li><a href="#home">App</a></li> 
							<li><a href="mailto:service@dinneract.com">Contact</a></li>
							<!--support right now is not a popup -->
							<!-- <li><a href="#contact">Support</a></li> -->
							<li><a href="#terms" data-toggle="modal" data-backdrop="static">Terms</a></li> 
							<li><a href="#privacy" data-toggle="modal" data-backdrop="static">Privacy</a></li> 
				   		</ul>
					</div>
				</div>
			   	<div class="footer-right">
						<ul class="list-inline social-buttons">
	                        <li>
	                        	<a href="https://twitter.com/DinneractInc" target="_blank" class="tw">
	                        		<i class="fa fa-twitter" title="Twitter"></i>
	                        	</a>
	                        </li>
	                        <li>
	                        	<a href="https://www.facebook.com/dinneract" target="_blank" class="fb">
	                        		<i class="fa fa-facebook" title="Facebook"></i>
	                        	</a>
	                        </li>
	                        <li>
	                        	<a href="https://www.pinterest.com/dinneract/" target="_blank" class="pin">
	                        		<i class="fa fa-pinterest-p" title="Pinterest"></i>
	                        	</a>
	                        </li>
	                        <li>
	                        	<a href="https://instagram.com/dinneract/" target="_blank" class="inst">
	                        		<i class="fa fa-instagram" title="Instagram"></i>
	                        	</a>
	                        </li>
	                        <!--<li>
	                        	<a href="https://plus.google.com/u/3/107570138513629378277/posts" target="_blank" class="gplus">
	                        		<i class="fa fa-google-plus" title="Google+"></i>
	                        	</a>
	                        </li>-->
	                    </ul>
			 	</div>
	         	<div class="clear"></div>

        	<a href="#" id="toTop" style="display: block;"><span id="toTopHover" style="opacity: 1;"></span></a>
		</div>
		<!---//End-wrap---->
	</div>
	<!---//End-footer----->
	<div class="copy copy-dash">
		<p>&copy; 2014-2015 <a href="index.html"> Dinneract</a></p>
	</div>
	

	
	<!-- Modal -->
	<div id="elemDetail" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	 <div class="modal-dialog" style="width: 960px; height: 600px;">
	    <div class="modal-content">
	      <div class="modal-header">
	      	
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	        <h4>Product Details</h4>
	      </div>
	      <div class="modal-body" style="overflow-y: auto;">
	      	
	      	<h4 id="title"></h4><br/>
	      	
	      	<div class="form-group">
				<label class="col-sm-4 control-label">Brand Name: </label>
				<div class="col-sm-8" id="brand"></div>
			</div>
	      		
	      	<div class="form-group">
				<label class="col-sm-4 control-label">Vendor: </label>
				<div class="col-sm-8" id="brand">
					<a href="" id="vendor" target="_blank"></a>
				</div>
			</div>
	      	
	      	<div class="form-group">
				<label class="col-sm-4 control-label">Price: </label>
				<div class="col-sm-4" id="price"></div>
				<div class="col-sm-4" >
					<a href="" id="buyLink" target="_blank">Buy</a>
				</div>
			</div>
			
			<div class="form-group" style="height: 400px;">
				<div id="photos" class="col-sm-12 carousel slide carousel-fade" data-ride="carousel">	  	
					<div class="carousel-inner">
					</div>
	
					<a class="carousel-control left" href="#photos" data-slide="prev">&lsaquo;</a>
					<a class="carousel-control right" href="#photos" data-slide="next">&rsaquo;</a>	
				</div>
			</div>
		
			<div class="form-group">
				<label class="col-sm-4 control-label">Introduction: </label>
				<div class="col-sm-8" id="intro"></div>
			</div>

			<div class="form-group">
				<label class="col-sm-4 control-label">Certificates: </label>
				<div class="col-sm-8" id="certificates"></div>
			</div>

			<div class="form-group">
				<label class="col-sm-4 control-label">Tags: </label>
				<div class="col-sm-8" id="tags"></div>
			</div>
	
			<div class="form-group">
				<label class="col-sm-4 control-label">Categories: </label>
				<div class="col-sm-8" id="categories"></div>
			</div>

			<div class="form-group">
				<label class="col-sm-4 control-label">Ingredients: </label>
				<div class="col-sm-8" id="ingredients"></div>
			</div>
			
	      </div>
	      <div class="modal-footer">
	        <a type="button" class="btn btn-default" data-dismiss="modal">Close</a>
	      </div>
	    </div><!-- /.modal-content -->
	  </div><!-- /.modal-dialog -->
	</div>
	<!-- End of Modal -->
	
	
	
	<!-- Modal -->
	<div id="terms" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	</div>
	<!-- End of Modal -->	
	
	
	<!-- Modal -->
	<div id="privacy" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	</div>
	<!-- End of Modal -->


	
	<script type="text/javascript">
		//global variables
		var elementPerPage = 12,
			pagePerView = 9,
			elementCache = [],
			currentPage = 1,
			currentPageGroup = 0;
			currentAmount = 0;
		
		var domain = "http://54.148.158.185:3000/";
		
		//loading modals
		$("#privacy").load("inc/privacy.inc"); 
		$("#terms").load("inc/terms.inc"); 

		
		$(document).ready(function() {
			
			loadElements( (currentPage - 1) * elementPerPage );
			
			$(".pagination li").click(function(e) {
				//e.preventDefault();
				
				if( $(this).attr("id") == "prevPages" ) {
					
					//$("#nextPages").removeClass("disabled");
					
					$(".pagination li").removeClass("active");
					
					if( currentPageGroup > 0 ) {
						$(this).removeClass("disabled");
						
						currentPageGroup--;
						
						for(var i=1; i<=pagePerView; i++) {
							$(".pagination li[title=" + i + "]").html("<a>" + (currentPageGroup*pagePerView + i) + "</a>");
						}
						
						if( currentPage > currentPageGroup*pagePerView && currentPage < (currentPageGroup+1)*pagePerView ) {
							$(".pagination li[title=" + (currentPage-currentPageGroup*pagePerView) + "]").addClass("active");
						}
					} else {
						$(this).addClass("disabled");
					}
					
				} else if( $(this).attr("id") == "nextPages" ) {
					
					$("#prevPages").removeClass("disabled");
					
					$(".pagination li").removeClass("active");

					if( currentAmount > 1 ) {
						$(this).removeClass("disabled");
						
						currentPageGroup++;
						
						for(var i=1; i<=pagePerView; i++) {
							$(".pagination li[title=" + i + "]").html("<a>" + (currentPageGroup*pagePerView + i) + "</a>");
						}
						
						if( currentPage > currentPageGroup*pagePerView && currentPage < (currentPageGroup+1)*pagePerView ) {
							$(".pagination li[title=" + (currentPage-currentPageGroup*pagePerView) + "]").addClass("active");
						}
					} else {
						$(this).addClass("disabled");
					}
					
				} else {
					currentPage = Number( $(this).find("a").text() );
					loadElements( (currentPage - 1) * elementPerPage );
					$(this).addClass("active");
    				$(".pagination li").not(this).removeClass("active");
				}
			});
			
		});//end of document.ready
		
		
		function popDetail(order) {
			
			//$('#photos').carousel('pause');
			
			var element = elementCache[order],
				photos = "";
			
			//var photos =  "<div class=\"active item\">" + 
			//		"<img src=\"" + element.thumb + "\" alt=\"product photo\" style=\"height:400px;\" />" + 
			//		"</div>";
			
			getVendor(element.vendor);
			
			$.each(element.photos, function( index, value ) {
				photos += "<div class=\"" + (index==0?"active ":"") + "item\">" + 
					"<img src=\"" + value + "\" alt=\"product photo\" style=\"height:400px;\" />" +
					"</div>";
			});

			
			$('#photos .carousel-inner').html(photos);
			
			$('#title').html(element.name);
			$('#brand').html(element.brand);
			
			
			$('#price').text( element.price.amount + " / " + ( element.price.unit.length < 1 ? "EACH" : element.price.unit ) );
			$('#buyLink').attr("href", element.url);
			
			$('#intro').html(element.intro);
			$('#certificates').html( element.certificates.length < 1 ? "None" : element.certificates.join(' , '));
			$('#tags').html(element.tags.length < 1 ? "None" : element.tags.join(' , '));
			$('#categories').html( element.category_1 + " > " + (element.category_2.length<1?"None":element.category_2) + " > " + (element.category_3.length<1?"None":element.category_3) );
			$('#ingredients').html( element.ingredients.length < 1 ? "None" : element.ingredients );
			
			// ready to popup
			$('#photos').carousel({
				interval: 5000
			});
			
			$('#elemDetail').modal('show');
		}
		
		function loadElements(offset) {
			var apiURL = domain + "elements?offset=" + offset + "&sort=name";
			//var apiURL = "allElements.json";
					
			$.ajax({
				type: "GET",      
				url: apiURL,
				cache: false,
				crossDomain: true,
				dataType: 'json',
				
				beforeSend: (function(myElements) {
					$('#loading').show();
				}),	
				
				success: (function(myElements) {
					
					$('#loading').hide();
					
				    var elements = "";
				    elementCache = myElements;
				    currentAmount = elementCache.length;
				    
					$.each( myElements, function( i, element ) {
				    	elements += "<div class=\"post\" onclick=\"popDetail(" + i + ");\">" +
				    				"<div class=\"like\">" +
				    				"</div>" + 
				    				"<a><img src=\"" + element.thumb + "\" alt=\"\" class=\"img-rounded\"></a>" + 
				    				"<label>" + element.name + "</label>" + 
								 "</div>";
				    });
				        	
				    var $container = $('#product-images');
				    if($container.html().length > 0) {
				    	$container.masonry( 'destroy' );
				    }
				    $container.html(elements);
				    // initialize
				    $container.imagesLoaded( function() {
				      	$container.masonry({
				      			columnWidth: 260,
				      			itemSelector: '.post',
				      			isAnimated: true
				      	});
					});  
				}),
				
				error: (function( jqXHR, textStatus ) {
					$('#loading').hide();
					currentAmount = 1;
					alert( "Request failed: " + textStatus );
				})
			});
		}
		
		function getVendor(vendorID) {
			var apiURL = domain + "vendors?id=" + vendorID;
					
			$.ajax({
				type: "GET",      
				url: apiURL,
				cache: false,
				crossDomain: true,
				dataType: 'json',
				
				success: (function(vendorInfo) {
					
				    $('#vendor').text( vendorInfo.name + ( vendorInfo.location.length < 1 ? "" : ("("+vendorInfo.location+")") ) );   
				    $('#vendor').attr("href", vendorInfo.website);	
				}),
				
				error: (function( jqXHR, textStatus ) {
					console.log( "Request failed: " + textStatus );
					$('#vendor').text(element.vendor);
				})
			});
		}
	</script>
</body>
</html>